<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/flashcardapp/SignUpActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/flashcardapp/SignUpActivity.kt" />
              <option name="originalContent" value="package com.example.flashcardapp&#10;&#10;import android.content.Intent&#10;import android.os.Bundle&#10;import android.util.Log&#10;import androidx.appcompat.app.AppCompatActivity&#10;import com.example.flashcardapp.databinding.SignUpBinding&#10;import com.example.flashcardapp.model.User&#10;import android.widget.Toast&#10;import androidx.lifecycle.lifecycleScope&#10;import io.github.jan.supabase.auth.providers.builtin.Email&#10;import io.github.jan.supabase.auth.auth&#10;import io.github.jan.supabase.postgrest.from&#10;import kotlinx.coroutines.launch&#10;&#10;class SignUpActivity : AppCompatActivity() {&#10;    lateinit var binding: SignUpBinding&#10;&#10;    companion object {&#10;        private const val TAG = &quot;SignUpActivity&quot;&#10;    }&#10;&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        binding = SignUpBinding.inflate(layoutInflater)&#10;        setContentView(binding.root)&#10;&#10;        // Navigate to SignIn when &quot;Already registered&quot; button is clicked&#10;        binding.alreadyRegisteredButton.setOnClickListener {&#10;            Log.d(TAG, &quot;Already registered button clicked, navigating to SigninActivity&quot;)&#10;            val intent = Intent(this, SigninActivity::class.java)&#10;            startActivity(intent)&#10;            finish()&#10;        }&#10;&#10;        // Listen to the Sign Up button click&#10;        binding.signUpButton.setOnClickListener {&#10;            val username = binding.usernameInput.text?.toString()?.trim() ?: &quot;&quot;&#10;            val email = binding.emailInput.text?.toString()?.trim() ?: &quot;&quot;&#10;            val password = binding.passwordInput.text?.toString() ?: &quot;&quot;&#10;            val retype = binding.retypePasswordInput.text?.toString() ?: &quot;&quot;&#10;&#10;            Log.d(TAG, &quot;Sign up button clicked. Username: $username, Email: $email&quot;)&#10;&#10;            // Basic validation&#10;            if (username.isEmpty() || email.isEmpty() || password.isEmpty() || retype.isEmpty()) {&#10;                Log.w(TAG, &quot;Validation failed: One or more fields are empty&quot;)&#10;                Toast.makeText(this, &quot;Please fill all fields&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;&#10;            if (password != retype) {&#10;                Log.w(TAG, &quot;Validation failed: Passwords do not match&quot;)&#10;                Toast.makeText(this, &quot;Passwords do not match&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;&#10;            // Perform sign-up with Supabase in a coroutine&#10;            Log.d(TAG, &quot;Starting sign up process...&quot;)&#10;            lifecycleScope.launch {&#10;                try {&#10;                    Log.d(TAG, &quot;Attempting to sign up with Supabase Auth...&quot;)&#10;                    val signUpResult = SupabaseProvider.client.auth.signUpWith(Email) {&#10;                        this.email = email&#10;                        this.password = password&#10;                    }&#10;&#10;                    // Extract user id from the sign-up result&#10;                    // The signUpResult object contains the user data&#10;                    val userId = signUpResult?.id&#10;                    Log.d(TAG, &quot;Sign up successful. User ID: $userId&quot;)&#10;&#10;                    if (userId == null) {&#10;                        Log.e(TAG, &quot;Sign up failed: Could not get user ID from result&quot;)&#10;                        Toast.makeText(this@SignUpActivity, &quot;Sign up failed: Could not get user ID&quot;, Toast.LENGTH_SHORT).show()&#10;                        return@launch&#10;                    }&#10;&#10;                    // Insert into &quot;User&quot; table with correct field names from User.kt model&#10;                    try {&#10;                        val newUser = User(&#10;                            id = null, // Will be auto-incremented by Supabase&#10;                            username = username,&#10;                            today = 0,&#10;                            total_created = 0,&#10;                            total_learned = 0,&#10;                            user_id = userId&#10;                        )&#10;&#10;                        Log.d(TAG, &quot;Inserting user data into database: $newUser&quot;)&#10;&#10;                        // Use Postgrest to insert (id will be auto-incremented by Supabase)&#10;                        SupabaseProvider.client.from(&quot;User&quot;).insert(newUser)&#10;&#10;                        Log.d(TAG, &quot;User data inserted successfully into database&quot;)&#10;                        Toast.makeText(this@SignUpActivity, &quot;Sign up successful! Please sign in.&quot;, Toast.LENGTH_SHORT).show()&#10;&#10;                        // Navigate to sign in screen&#10;                        Log.d(TAG, &quot;Navigating to sign in screen...&quot;)&#10;                        val intent = Intent(this@SignUpActivity, SigninActivity::class.java)&#10;                        startActivity(intent)&#10;                        finish()&#10;&#10;                    } catch (e: Exception) {&#10;                        Log.e(TAG, &quot;Failed to create user record in database&quot;, e)&#10;                        Log.e(TAG, &quot;Error type: ${e::class.simpleName}&quot;)&#10;                        Log.e(TAG, &quot;Error message: ${e.message}&quot;)&#10;                        Log.e(TAG, &quot;Stack trace:&quot;, e)&#10;                        Toast.makeText(this@SignUpActivity, &quot;Failed to create user record: ${e.message}&quot;, Toast.LENGTH_SHORT).show()&#10;                    }&#10;&#10;                } catch (e: Exception) {&#10;                    Log.e(TAG, &quot;Sign up failed during authentication&quot;, e)&#10;                    Log.e(TAG, &quot;Error type: ${e::class.simpleName}&quot;)&#10;                    Log.e(TAG, &quot;Error message: ${e.message}&quot;)&#10;                    Log.e(TAG, &quot;Stack trace:&quot;, e)&#10;                    Toast.makeText(this@SignUpActivity, &quot;Sign up failed: ${e.message}&quot;, Toast.LENGTH_SHORT).show()&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.flashcardapp&#10;&#10;import android.content.Intent&#10;import android.os.Bundle&#10;import android.util.Log&#10;import androidx.appcompat.app.AppCompatActivity&#10;import com.example.flashcardapp.databinding.SignUpBinding&#10;import com.example.flashcardapp.model.User&#10;import android.widget.Toast&#10;import androidx.lifecycle.lifecycleScope&#10;import io.github.jan.supabase.auth.providers.builtin.Email&#10;import io.github.jan.supabase.auth.auth&#10;import io.github.jan.supabase.postgrest.from&#10;import kotlinx.coroutines.launch&#10;&#10;class SignUpActivity : AppCompatActivity() {&#10;    lateinit var binding: SignUpBinding&#10;&#10;    companion object {&#10;        private const val TAG = &quot;SignUpActivity&quot;&#10;    }&#10;&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        binding = SignUpBinding.inflate(layoutInflater)&#10;        setContentView(binding.root)&#10;&#10;        // Navigate to SignIn when &quot;Already registered&quot; button is clicked&#10;        binding.alreadyRegisteredButton.setOnClickListener {&#10;            Log.d(TAG, &quot;Already registered button clicked, navigating to SigninActivity&quot;)&#10;            val intent = Intent(this, SigninActivity::class.java)&#10;            startActivity(intent)&#10;            finish()&#10;        }&#10;&#10;        // Listen to the Sign Up button click&#10;        binding.signUpButton.setOnClickListener {&#10;            val username = binding.usernameInput.text?.toString()?.trim() ?: &quot;&quot;&#10;            val email = binding.emailInput.text?.toString()?.trim() ?: &quot;&quot;&#10;            val password = binding.passwordInput.text?.toString() ?: &quot;&quot;&#10;            val retype = binding.retypePasswordInput.text?.toString() ?: &quot;&quot;&#10;&#10;            Log.d(TAG, &quot;Sign up button clicked. Username: $username, Email: $email&quot;)&#10;&#10;            // Basic validation&#10;            if (username.isEmpty() || email.isEmpty() || password.isEmpty() || retype.isEmpty()) {&#10;                Log.w(TAG, &quot;Validation failed: One or more fields are empty&quot;)&#10;                Toast.makeText(this, &quot;Please fill all fields&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;&#10;            if (password != retype) {&#10;                Log.w(TAG, &quot;Validation failed: Passwords do not match&quot;)&#10;                Toast.makeText(this, &quot;Passwords do not match&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;&#10;            // Perform sign-up with Supabase in a coroutine&#10;            Log.d(TAG, &quot;Starting sign up process...&quot;)&#10;            lifecycleScope.launch {&#10;                try {&#10;                    Log.d(TAG, &quot;Attempting to sign up with Supabase Auth...&quot;)&#10;                    val signUpResult = SupabaseProvider.client.auth.signUpWith(Email) {&#10;                        this.email = email&#10;                        this.password = password&#10;                    }&#10;&#10;                    // Extract user id from the sign-up result&#10;                    // The signUpResult object contains the user data&#10;                    val userId = signUpResult?.id&#10;                    Log.d(TAG, &quot;Sign up successful. User ID: $userId&quot;)&#10;&#10;                    if (userId == null) {&#10;                        Log.e(TAG, &quot;Sign up failed: Could not get user ID from result&quot;)&#10;                        Toast.makeText(this@SignUpActivity, &quot;Sign up failed: Could not get user ID&quot;, Toast.LENGTH_SHORT).show()&#10;                        return@launch&#10;                    }&#10;&#10;                    // Insert into &quot;User&quot; table with correct field names from User.kt model&#10;                    try {&#10;                        val newUser = User(&#10;                            id = null, // Will be auto-incremented by Supabase&#10;                            username = username,&#10;                            today = 0,&#10;                            total_created = 0,&#10;                            total_learned = 0,&#10;                            user_id = userId&#10;                        )&#10;&#10;                        Log.d(TAG, &quot;Inserting user data into database: $newUser&quot;)&#10;&#10;                        // Use Postgrest to insert (id will be auto-incremented by Supabase)&#10;                        SupabaseProvider.client.from(&quot;User&quot;).insert(newUser)&#10;&#10;                        Log.d(TAG, &quot;User data inserted successfully into database&quot;)&#10;                        Toast.makeText(this@SignUpActivity, &quot;Sign up successful! Please sign in.&quot;, Toast.LENGTH_SHORT).show()&#10;&#10;                        // Navigate to sign in screen&#10;                        Log.d(TAG, &quot;Navigating to sign in screen...&quot;)&#10;                        val intent = Intent(this@SignUpActivity, SigninActivity::class.java)&#10;                        startActivity(intent)&#10;                        finish()&#10;&#10;                    } catch (e: Exception) {&#10;                        Log.e(TAG, &quot;Failed to create user record in database&quot;, e)&#10;                        Log.e(TAG, &quot;Error type: ${e::class.simpleName}&quot;)&#10;                        Log.e(TAG, &quot;Error message: ${e.message}&quot;)&#10;                        Log.e(TAG, &quot;Stack trace:&quot;, e)&#10;                        Toast.makeText(this@SignUpActivity, &quot;Failed to create user record: ${e.message}&quot;, Toast.LENGTH_SHORT).show()&#10;                    }&#10;&#10;                } catch (e: Exception) {&#10;                    Log.e(TAG, &quot;Sign up failed during authentication&quot;, e)&#10;                    Log.e(TAG, &quot;Error type: ${e::class.simpleName}&quot;)&#10;                    Log.e(TAG, &quot;Error message: ${e.message}&quot;)&#10;                    Log.e(TAG, &quot;Stack trace:&quot;, e)&#10;                    Toast.makeText(this@SignUpActivity, &quot;Sign up failed: ${e.message}&quot;, Toast.LENGTH_SHORT).show()&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>